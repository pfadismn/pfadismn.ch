<%= semantic_form_for [@ou, @member] do |f| %>
  <%= f.error_messages %>

  <%= f.inputs t(:general) do %>
    <%= image_tag avatar_organisational_unit_member_path(@ou, @member, size: :thumb), class: :avatar unless @member.new_record? %>
    <%= f.inputs 'Firstname, Lastname', class: :doublefield do %>
      <%= f.input :first_name %>
      <%= f.input :last_name %>
    <% end %>
    <%= f.input :scout_name %>
    <%= f.input :birthdate, start_year: Time.now.year - 40, end_year: Time.now.year %>
    <%= f.input :nationality %>
    <%= f.input :gender, :as => :radio, collection: Member::GENDERS %>
    <%= f.input :avatar %>
  <% end %>

  <%= f.inputs t :contact_information do %>
    <%= f.input :alias %>
    <%= f.input :email %>
    <% unless @member.new_record? %>
      <%= form_element t(:phone_numbers) do %>
        <% @member.phone_numbers.each do |p| %>
          <%= link_to t(:remove_phone_number), [@ou, @member, p], method: :delete, confirm: :really_delete? %>
          <%= formatted_phone_number p %>
        <% end %>
        <%= link_to t(:add_phone_number), [:new, @ou, @member, PhoneNumber.model_name.underscore] %>
      <% end %>
      <%= form_element t(:addresses) do %>
        <% @member.addresses.each do |a| %>
          <%= link_to t(:remove_address), [@ou, @member, a], method: :delete, confirm: :really_delete? %>
          <%= formatted_address a %>
        <% end %>
        <%= link_to t(:add_address), [:new, @ou, @member, Address.model_name.underscore] %>
      <% end %>
      <%= form_element t(:contacts) do %>
        <% @member.contacts.each do |c| %>
          <%= link_to t(:remove_contact), [@ou, @member, c], method: :delete, confirm: :really_delete? %>
          <%= link_to c %>
        <% end %>
        <%= link_to t(:add_contact), [:new, @ou, @member, Contact.model_name.underscore] %>
      <% end %>
    <% end %>
  <% end %>

  <%= f.inputs t :scout do %>
    <%= f.input :organisational_unit, as: :select, input_html: { class: 'chosen-select' }, wrapper_html: { class: 'chosen' }, collection: OrganisationalUnit.all, member_label: :to_s, include_blank: false %>
    <%= f.input :functions, as: :hidden, input_html: { name:'member[functions][]', value: 0 } %>
    <%= f.input :functions, as: :select, input_html: { multiple: true, class: 'chosen-select',  name:'member[functions][]', value: @member.functions }, wrapper_html: { class: 'chosen' }, collection: MemberFunction::FUNCTIONS.map{ |f| [t(f), f] }, include_blank: false %>
    <%= f.input :education %>
    <%= f.input :member_since, start_year: Time.now.year - 30, end_year: Time.now.year%>
  <% end %>

  <%= f.inputs t :additional_info do %>
    <%= f.input :remarks %>
    <%= f.input :vegetarian %>
  <% end %>

  <%= f.actions %>
<% end %>